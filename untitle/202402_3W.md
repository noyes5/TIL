## kafka

카프카를 사용하면 순서를 보장할수있다.

producer -> kafka -> consumer 

1. topic이라는 주제를 통해서 원하는 값들을 저장할 수 있다.
2. 토픽 내에는 파티션0/파티션1/파티션2 과 같이 나누어져있으며 이 안에는 오프셋 형태로 값이 저장된다.(key-value에서 key 값과 유사)
3. 단 값이 저장된 이후에는 수정이나 삭제가 불가능하다. 순차적으로 기록만 가능함.
4. 기록할 파티션을 미리 결정하는건 kafka가 아니라 producer.


### producer는 키를 가지고 있을수도 있고 null 일수도 있다.
1.key가 null이라면 round-robin 형태로 데이터가 보내진다. -> 파티션0,1,2,....순 로드밸런싱을 하게 됨.
2.key가 != null 이면, 동일한 키를 공유하는 모든 메시지는 동일한 파티션에 기록된다.

카프카 메시지 구조
![Alt text](image.png)

key, value 모두 keySerializer를 통해 직렬화되어 바이너리 데이터로 바뀌어 kafka로 보내진다.

반대로 consumer에서 받을때는 KeyDeserializer를 통해 해석할 수 있게 된다.

### consumer group offset은주기적으로 값을 commit한다.

...계속 공부 중

##  비즈니스로직 처리 방법

1. 도메인모델 패턴 ; 엔티티가 비즈니스 로직을 가지고 객체 지향적으로 핵심 로직 수행. 서비스 계층은 단순히 요청 위임
2. 트랜잭션 스크립트 패턴 : 엔티티에는 비즈니스로직이 거의 없고 서비스 계층에서 처리하는 것


